/**
 * Accessibility Styles
 * ====================
 * WCAG 2.1 AA compliant styling for focus, skip links, and screen readers.
 */

/* ============================================
   SKIP LINKS
   ============================================ */

.skip-link {
	position: absolute;
	top: -100%;
	left: 50%;
	transform: translateX(-50%);
	z-index: 10000;
	padding: 12px 24px;
	background: var(--cw-accent-primary, #58A6FF);
	color: var(--cw-background, #0D1117);
	font-weight: 600;
	text-decoration: none;
	border-radius: 0 0 8px 8px;
	transition: top 150ms ease;
}

.skip-link:focus {
	top: 0;
	outline: none;
}

/* ============================================
   FOCUS INDICATORS
   ============================================ */

/* High-visibility focus ring for all interactive elements */
:focus-visible {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: 2px;
}

/* Remove default outline, rely on :focus-visible */
:focus:not(:focus-visible) {
	outline: none;
}

/* Enhanced focus for buttons */
button:focus-visible,
.cw-btn:focus-visible,
[role="button"]:focus-visible {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: 2px;
	box-shadow: 0 0 0 4px rgba(88, 166, 255, 0.25);
}

/* Enhanced focus for inputs */
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
.cw-input:focus-visible {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: 0;
	border-color: var(--cw-accent-primary, #58A6FF);
}

/* Enhanced focus for links */
a:focus-visible {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: 2px;
	border-radius: 2px;
}

/* Focus within for composite components */
.focus-within:focus-within {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: 2px;
}

/* ============================================
   SCREEN READER ONLY
   ============================================ */

.sr-only {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	white-space: nowrap;
	border: 0;
}

/* Make visible when focused (for skip links) */
.sr-only-focusable:focus,
.sr-only-focusable:active {
	position: static;
	width: auto;
	height: auto;
	padding: inherit;
	margin: inherit;
	overflow: visible;
	clip: auto;
	white-space: normal;
}

/* ============================================
   REDUCED MOTION
   ============================================ */

@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
		scroll-behavior: auto !important;
	}
}

/* ============================================
   HIGH CONTRAST MODE
   ============================================ */

@media (prefers-contrast: high) {
	:root {
		--cw-background: #000000;
		--cw-text: #FFFFFF;
		--cw-border: #FFFFFF;
		--cw-accent-primary: #FFFF00;
	}

	button,
	.cw-btn,
	[role="button"] {
		border: 2px solid currentColor;
	}

	a {
		text-decoration: underline;
	}
}

/* ============================================
   FORCED COLORS (Windows High Contrast)
   ============================================ */

@media (forced-colors: active) {
	.cw-btn,
	button,
	[role="button"] {
		border: 2px solid ButtonText;
	}

	:focus-visible {
		outline: 3px solid Highlight;
		outline-offset: 2px;
	}

	.cw-panel,
	.cw-card {
		border: 1px solid CanvasText;
	}
}

/* ============================================
   FOCUS TRAP INDICATOR
   ============================================ */

[data-focus-trap="active"] {
	position: relative;
}

[data-focus-trap="active"]::before {
	content: '';
	position: absolute;
	inset: -4px;
	border: 2px dashed var(--cw-accent-primary, #58A6FF);
	border-radius: 8px;
	pointer-events: none;
	opacity: 0;
	transition: opacity 150ms ease;
}

[data-focus-trap="active"]:focus-within::before {
	opacity: 0.5;
}

/* ============================================
   ARIA STATE INDICATORS
   ============================================ */

/* Disabled state */
[aria-disabled="true"],
[disabled] {
	opacity: 0.5;
	cursor: not-allowed;
	pointer-events: none;
}

/* Busy/loading state */
[aria-busy="true"] {
	cursor: wait;
}

/* Invalid state */
[aria-invalid="true"] {
	border-color: var(--cw-danger, #F85149) !important;
}

[aria-invalid="true"]:focus-visible {
	outline-color: var(--cw-danger, #F85149);
	box-shadow: 0 0 0 4px rgba(248, 81, 73, 0.25);
}

/* Expanded state indicator */
[aria-expanded="true"] .expand-icon {
	transform: rotate(180deg);
}

/* Selected state */
[aria-selected="true"] {
	background: var(--cw-accent-primary-alpha, rgba(88, 166, 255, 0.15));
}

/* Current page in navigation */
[aria-current="page"] {
	font-weight: 600;
	color: var(--cw-accent-primary, #58A6FF);
}

/* ============================================
   KEYBOARD NAVIGATION HELPERS
   ============================================ */

/* Tab list styling */
[role="tablist"] {
	display: flex;
	gap: 4px;
}

[role="tab"] {
	padding: 8px 16px;
	background: transparent;
	border: none;
	border-bottom: 2px solid transparent;
	color: var(--cw-secondary-text, #8B949E);
	cursor: pointer;
	transition: color 150ms ease, border-color 150ms ease;
}

[role="tab"]:hover {
	color: var(--cw-text, #E6EDF3);
}

[role="tab"][aria-selected="true"] {
	color: var(--cw-accent-primary, #58A6FF);
	border-bottom-color: var(--cw-accent-primary, #58A6FF);
}

[role="tab"]:focus-visible {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: -2px;
}

[role="tabpanel"] {
	padding: 16px;
}

[role="tabpanel"]:focus-visible {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: 2px;
}

/* Menu styling */
[role="menu"] {
	list-style: none;
	padding: 4px;
	margin: 0;
}

[role="menuitem"] {
	padding: 8px 12px;
	cursor: pointer;
	border-radius: 4px;
	transition: background 150ms ease;
}

[role="menuitem"]:hover,
[role="menuitem"]:focus {
	background: var(--cw-hover, rgba(255, 255, 255, 0.05));
}

[role="menuitem"]:focus-visible {
	outline: 2px solid var(--cw-accent-primary, #58A6FF);
	outline-offset: -2px;
}

/* ============================================
   LIVE REGIONS
   ============================================ */

/* Announcer element (screen reader only) */
#sr-announcer {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	white-space: nowrap;
	border: 0;
}

/* Status messages */
[role="status"],
[role="alert"] {
	/* These are announced automatically */
}

[role="alert"] {
	padding: 12px 16px;
	background: var(--cw-danger-alpha, rgba(248, 81, 73, 0.15));
	border-left: 4px solid var(--cw-danger, #F85149);
	border-radius: 4px;
}

/* ============================================
   FORM ACCESSIBILITY
   ============================================ */

/* Required field indicator */
.required-indicator {
	color: var(--cw-danger, #F85149);
	margin-left: 4px;
}

/* Error messages */
.field-error {
	color: var(--cw-danger, #F85149);
	font-size: 0.875rem;
	margin-top: 4px;
}

/* Help text */
.field-help {
	color: var(--cw-secondary-text, #8B949E);
	font-size: 0.875rem;
	margin-top: 4px;
}

/* Fieldset and legend */
fieldset {
	border: 1px solid var(--cw-border, #1E2A36);
	border-radius: 8px;
	padding: 16px;
	margin: 0 0 16px 0;
}

legend {
	padding: 0 8px;
	font-weight: 600;
	color: var(--cw-text, #E6EDF3);
}

/* ============================================
   TOUCH ACCESSIBILITY
   ============================================ */

/* Ensure minimum touch target size */
@media (pointer: coarse) {
	.touch-target {
		min-height: 44px;
		min-width: 44px;
	}

	/* Increase spacing between interactive elements */
	.touch-spacing > * + * {
		margin-top: 8px;
	}
}

/* ============================================
   TEXT ACCESSIBILITY
   ============================================ */

/* Ensure readable line length */
.readable-width {
	max-width: 70ch;
}

/* Ensure readable line height */
.readable-text {
	line-height: 1.5;
}

/* Large text option */
.text-large {
	font-size: 1.125rem;
}

/* ============================================
   COLOR BLIND FRIENDLY
   ============================================ */

/* Add patterns/icons alongside colors */
.status-success::before {
	content: '✓ ';
}

.status-error::before {
	content: '✗ ';
}

.status-warning::before {
	content: '⚠ ';
}

.status-info::before {
	content: 'ℹ ';
}
